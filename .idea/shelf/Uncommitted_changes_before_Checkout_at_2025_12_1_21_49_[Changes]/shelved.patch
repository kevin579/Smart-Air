Index: app/src/test/java/com/example/SmartAirGroup2/LoginPresenterTest.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.SmartAirGroup2;\r\n\r\nimport com.example.SmartAirGroup2.auth.data.repo.AuthRepository;\r\nimport com.example.SmartAirGroup2.auth.login.LoginContract;\r\nimport com.example.SmartAirGroup2.auth.login.LoginPresenter;\r\n\r\nimport org.junit.Before;\r\nimport org.junit.Test;\r\nimport org.junit.runner.RunWith;\r\nimport org.mockito.ArgumentMatchers;\r\nimport org.mockito.Mock;\r\nimport org.mockito.Mockito;\r\nimport org.mockito.MockitoAnnotations;\r\nimport org.mockito.junit.MockitoJUnitRunner;\r\n\r\nimport static org.mockito.ArgumentMatchers.any;\r\nimport static org.mockito.ArgumentMatchers.anyString;\r\nimport static org.mockito.ArgumentMatchers.eq;\r\nimport static org.mockito.Mockito.*;\r\n\r\nimport android.os.Handler;\r\nimport android.os.Looper;\r\n\r\n/**\r\n * Unit tests for LoginPresenter\r\n * Tests the business logic of login validation and authentication\r\n */\r\n@RunWith(MockitoJUnitRunner.class)\r\npublic class LoginPresenterTest {\r\n\r\n    @Mock\r\n    private LoginContract.View mockView;\r\n\r\n    @Mock\r\n    private AuthRepository mockAuthRepository;\r\n\r\n    @Mock\r\n    private Handler mockHandler;\r\n\r\n    private LoginPresenter presenter;\r\n\r\n    @Before\r\n    public void setUp() {\r\n        MockitoAnnotations.openMocks(this);\r\n\r\n        doAnswer(invocation -> {\r\n            Runnable r = invocation.getArgument(0);\r\n            r.run();\r\n            return true;\r\n        }).when(mockHandler).post(any(Runnable.class));\r\n\r\n        // 使用带 Handler 参数的构造函数\r\n        presenter = new LoginPresenter(mockAuthRepository, mockHandler);\r\n        presenter.attach(mockView);\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_emptyEmail(){\r\n        String email = \"\";\r\n        presenter.onLoginClicked(\"parent\", \"perry\", email, \"!Abc12345\");\r\n        Mockito.verify(mockView).showLoginFailed();\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_nullEmail(){\r\n        String email = null;\r\n        presenter.onLoginClicked(\"parent\", \"perry\", email, \"!Abc12345\");\r\n        Mockito.verify(mockView).showLoginFailed();\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_emptyUname(){\r\n        String Uname = \"\";\r\n        presenter.onLoginClicked(\"parent\",Uname , \"perry@gmail.com\", \"!Abc12345\");\r\n        Mockito.verify(mockView).showLoginFailed();\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_nullUname(){\r\n        String Uname = null;\r\n        presenter.onLoginClicked(\"parent\", Uname, \"perry@gmail.com\", \"!Abc12345\");\r\n        Mockito.verify(mockView).showLoginFailed();\r\n    }  @Test\r\n\r\n    public void testLogin_emptyPassward(){\r\n        String passward = \"\";\r\n        presenter.onLoginClicked(\"parent\", \"perry\", \"perry@gmail.com\", passward);\r\n        Mockito.verify(mockView).showLoginFailed();\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_nullPassward(){\r\n        String passward = null;\r\n        presenter.onLoginClicked(\"parent\", \"perry\", \"perry@gmail.com\", passward);\r\n        Mockito.verify(mockView).showLoginFailed();\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_nullView_emptyPassword(){\r\n        presenter.detach();\r\n        presenter.onLoginClicked(\"parent\", \"perry\", \"perry@gmail.com\", \"\");\r\n        Mockito.verifyNoInteractions(mockView);\r\n        Mockito.verifyNoInteractions(mockAuthRepository);\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_nullView () throws Exception{\r\n        Mockito.when(mockAuthRepository.CheckPassword(\"parent\",\"perry\",\"perry@gmail.com\",\"!Abc12345\"))\r\n                .thenReturn(true);\r\n\r\n        presenter.detach();\r\n\r\n        presenter.onLoginClicked(\"parent\",\"perry\",\"perry@gmail.com\",\"!Abc12345\");\r\n        Thread.sleep(50);\r\n\r\n        Mockito.verify(mockAuthRepository).CheckPassword(ArgumentMatchers.anyString(), ArgumentMatchers.anyString(), ArgumentMatchers.anyString(), ArgumentMatchers.anyString());\r\n        Mockito.verifyNoInteractions(mockView);\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_loginSuccess() throws Exception{\r\n        Mockito.when(mockAuthRepository.CheckPassword(\"parent\",\"perry\",\"perry@gmail.com\",\"!Abc12345\"\r\n        )).thenReturn(true);\r\n\r\n        presenter.onLoginClicked(\"parent\",\"perry\",\"perry@gmail.com\",\"!Abc12345\");\r\n        Thread.sleep(50);\r\n\r\n        Mockito.verify(mockView).showLoginSuccess(\"parent\");\r\n        Mockito.verify(mockView, Mockito.never()).showLoginFailed();\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_invalidCredentials() throws Exception {\r\n        when(mockAuthRepository.CheckPassword(\r\n                anyString(), anyString(), anyString(), anyString())\r\n        ).thenReturn(false);\r\n\r\n        presenter.onLoginClicked(\"parent\",\"perry\",\"perry@gmail.com\",\"wrongPass\");\r\n\r\n        Thread.sleep(50);\r\n\r\n        verify(mockView).showLoginFailed();\r\n    }\r\n\r\n\r\n    @Test\r\n    public void testLogin_throwException_nullView() throws Exception{\r\n        Mockito.when(mockAuthRepository.CheckPassword(ArgumentMatchers.anyString(), ArgumentMatchers.anyString(), ArgumentMatchers.anyString(), ArgumentMatchers.anyString()))\r\n                .thenThrow(new RuntimeException(\"Database connection failed\"));\r\n        presenter.detach();\r\n        presenter.onLoginClicked(\"child\",\"perry\",\"perry@gmail.com\",\"!Abc12345\");\r\n        Thread.sleep(50);\r\n\r\n        Mockito.verifyNoInteractions(mockView);\r\n    }\r\n\r\n    @Test\r\n    public void testLogin_throwException() throws Exception{\r\n        Mockito.when(mockAuthRepository.CheckPassword(ArgumentMatchers.anyString(), ArgumentMatchers.anyString(), ArgumentMatchers.anyString(), ArgumentMatchers.anyString()))\r\n                .thenThrow(new RuntimeException(\"failed\"));\r\n        presenter.onLoginClicked(\"child\",\"perry\",\"perry@gmail.com\",\"!Abc12345\");\r\n        Thread.sleep(50);\r\n\r\n        Mockito.verify(mockView).showInputError(\"failed\");\r\n        Mockito.verify(mockView).showLoginFailed();\r\n    }\r\n\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/test/java/com/example/SmartAirGroup2/LoginPresenterTest.java b/app/src/test/java/com/example/SmartAirGroup2/LoginPresenterTest.java
--- a/app/src/test/java/com/example/SmartAirGroup2/LoginPresenterTest.java	(revision 1bc9fd1b9a0076c62a2257eec1757ea81733e131)
+++ b/app/src/test/java/com/example/SmartAirGroup2/LoginPresenterTest.java	(date 1764643624622)
@@ -49,7 +49,6 @@
             return true;
         }).when(mockHandler).post(any(Runnable.class));
 
-        // 使用带 Handler 参数的构造函数
         presenter = new LoginPresenter(mockAuthRepository, mockHandler);
         presenter.attach(mockView);
     }
